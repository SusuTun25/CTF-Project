#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void secret_function() {
    printf("Congratulations! You've reached the secret function.\n");
    printf("Flag: FLAG{BufferOverflowMaster2}\n");
}

void vulnerable_function(char *input) {
    printf(input);  // Vulnerable usage of printf
    printf("\n");
}

int main() {
    char buffer[100];
    printf("Welcome to the format string challenge!\n");
    printf("Enter your input:\n");
    
    // Get user input
    fgets(buffer, sizeof(buffer), stdin);
    buffer[strcspn(buffer, "\n")] = '\0';  // Remove newline character

    // Call the vulnerable function with user input
    vulnerable_function(buffer);

    printf("Exiting...\n");
    return 0;
}
